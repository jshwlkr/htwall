
#   Copyright 2011 Joshua Walker

#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at

#       http://www.apache.org/licenses/LICENSE-2.0

#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License.

#	block access to the .htaccess file
<Files .htaccess>
 Order Allow,Deny
 Deny from all
</Files>

#	ensure the .htaccess file has the correcy CHMOD settings
chmod .htaccess files 644

#	disable directory browsing
Options All -Indexes

<IfModule mod_rewrite.c>
 RewriteEngine on 
 RewriteBase /
#	block attempts at system files
 RewriteCond %{QUERY_STRING} (environ(?!ment)|localhost|mosconfig) [NC,OR]
 RewriteCond %{QUERY_STRING} (etc/passwd|etc%2Fpasswd) [NC,OR]
 RewriteCond %{QUERY_STRING} boot\.ini [NC,OR]
#	block attempts at code injections
 RewriteCond %{QUERY_STRING} (<script>|%3Cscript%3E) [NC,OR]
#	block attempts at sql injections
 RewriteCond %{QUERY_STRING} (\'[0-9]\'\s*?=\s*?\'[0-9]\'|\'[0-9]\'\s*?%3D\s*?\'[0-9]\') [NC,OR]
 RewriteCond %{QUERY_STRING} ([0-9]\s*?=\s*?[0-9]|[0-9]\s*?%3D\s*?[0-9]) [NC,OR]
 RewriteCond %{QUERY_STRING} \* [NC]
 RewriteRule .* - [F]
</IfModule>
